import speech_recognition as sr
import pyttsx3
import pyjokes
import datetime
import random
import pywhatkit
import wikipedia
import webbrowser
# import time
# import requests
# from urllib.request import urlopen

engine = pyttsx3.init()

listener = sr.Recognizer()


def take(text):
    engine.say(text)
    engine.runAndWait()

def wishme():
    hour = int(datetime.datetime.now().hour)
    if hour >= 0 and hour < 12:
        take("Good Morning Sir !")

    elif hour >= 12 and hour < 18:
        take("Good Afternoon Sir !")

    else:
        take("Good Evening Sir !")

    assname = (" Friday 1 point o ")
    take("I am your Assistant")
    take(assname)

def talk(command):
    engine.say(command)
    engine.runAndWait()

def take_command():
    try:
        with sr.Microphone() as source:
            print("listening....")
            listener.pause_threshold = 1
            voice = listener.listen(source)
            command = listener.recognize_google(voice)
            command = command.lower()
            if 'friday' in command:
                command = command.replace('friday', '')
                print(command)

    except Exception as e:
        print("Say the command again")
        return "None"
    return command

def run_friday():
    command = take_command()
    print(command)
    if 'play' in command:
        song = command.replace('play', '')
        talk('playing'+song)
        pywhatkit.playonyt(song)
    elif 'time' in command:
        time = datetime.datetime.now().strftime('%H %M %p')
        print(time)
        talk("Current time is"+time)
    elif 'who is' in command:
        person = command.replace("who is", '')
        info = wikipedia.summary(person, 2)
        print(info)
        talk(info)
    elif 'joke' in command:
        joke = pyjokes.get_joke()
        print(joke)
        talk(joke)
    elif 'roll a dice' in command:
        choices = [1, 2, 3, 4, 5, 6]
        output = random.choice(choices)
        print(output)
        talk("The output is {}".format(output))
    elif 'flip a coin' in command:
        choices = ['Tails', 'Heads']
        output = random.choice(choices)
        print(output)
        talk(output)
    elif 'are you single' in command:
        talk("sorry i have a girlfriend")
        print("Sorry I Have a girlfriend")
    elif "will you go on a date with me" in command:
        talk("No i have fever")
    elif 'open youtube' in command:
        webbrowser.open("youtube.com")
    elif 'open google' in command:
        webbrowser.open("google.com")
    elif 'open stackoverflow' in command:
        webbrowser.open("stackoverflow.com")
    elif 'how are you' in command:
        talk("I am fine,Thank you")
        talk("How are you")
    elif "who created you" or 'who made you' in command:
        talk("I was created by JV2S")
    elif 'who i am' in command:
        talk("If you are talking and giving me commands then you are definitely human")
    elif "why you came to world" in command:
        talk("This is a secret i am not willing to tell")
    elif "hello testing 123" in command:
        talk("I am completely operational and all my circuits are working properly")
        print("I am completely operational and all my circuits are working properly")
    elif "can i call you jarvis" in command:
        talk("I think you have mistaken me for another intelligent assistant")
        print("I think you have mistaken me for another intelligent assistant")
        talk('Mr Stark is that you?')
        print('Mr Stark is that you?')
    elif 'can you dance with me' in command:
        talk("No these guilty feet have got no rhythm.Wait i have no feet")
        print("No these guilty feet have got no rhythm.Wait i have no feet")
    elif "when will the world end" in command:
        talk("Well,Unix 32-bit time overflows on January 19,2038.Maybe then,")
        print('''Well,Unix 32-bit time overflows
        on January 19,2038.Maybe then,''')
    elif 'how much wood would a woodchuck chuck if a woodchuck could chuck chuck wood' in command:
        talk("42?,That cant be right")
        print("42?,That cant be right")
        talk("How about another tongue twister")
        print("How about another tongue twister")
        with sr.Microphone() as source1:
            voice2 = listener.listen(source1)
            command1 = listener.recognize_google(voice2)
            command1 = command.lower()
            if 'ok' in command1:
                talk("""Peter Piper picked a peck of pickled pepper 
                A peck of pickled peppers Peter Piper picked
                 If Peter Piper picked a peck of pickled peppers 
                 Whereâ€™s the peck of pickled peppers Peter Piper picked?""")
                print("""Peter Piper picked a peck of pickled pepper 
                A peck of pickled peppers Peter Piper picked
                 If Peter Piper picked a peck of pickled peppers 
                 Whereâ€™s the peck of pickled peppers Peter Piper picked? """)
            else:
                talk("Ok Next time")
                print("OK Next time")

    elif "where is" in command:
        command = command.replace("where is", "")
        location = command
        talk("User asked to Locate")
        talk(location)
        webbrowser.open("https://www.google.nl / maps / place/" + location + "")
    elif 'quit' or 'exit' in command:
        talk("Thanks for giving me your time")
        exit()


wishme()

while True:
    run_friday()
